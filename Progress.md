# Максимизация покрытия ext4

 Здесь будет подробная информация о проделанной работе.

## Окружение

### Ядро


- **Версия** - 6.10.1 (используемые [тэг](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tag/?h=v6.10.1) и [коммит](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?h=v6.10.1))

- **Параметры конфигурации:**
    - В **menuconfig:**
        - `"CONFIG_DEBUG_FS=y"`
        - `“CONFIG_GCOV_KERNEL=y"`
        - `“CONFIG_XFS_FS=m"`
    - В **fs/ext4/Makefile:**
        - `“GCOV_PROFILE=y"`

### Хостовая машина

На ней собиралось ядро и анализировалось покрытие.

- OC - **Ubuntu 24.04**

### Тестовая машина

- OC - **Ubuntu 22.04**

- Является виртуальной машиной, запущенной с помощью **VirtualBox** версии 7.0.20 r163906 (Qt5.15.13) \
    (установлен с [официального сайта](https://www.virtualbox.org/), дата обращения: 24.07.2024).

- **Дисковое пространство:**
    - Корневой раздел был отформатирован как `xfs`, чтобы исключить влияние действий в этом разделе на итоговое покрытие.
    - Были созданные два раздела для тестирования размером по 10 GiB:
      - `/dev/sdb` - отформатирован как `ext4`.
      - `/dev/sdc` - не отформатирован.

### Тесты

Для сбора покрытия используется тестовый набор [xfstests](https://github.com/kdave/xfstests).

Тесты были собраны в соответствии с [инструкцией](https://github.com/kdave/xfstests/blob/master/README).

В конфигурации описанной выше запустилось 789 тестов, из которых 12 завершились некорректно.

### Покрытие

Для сбора и анализа покрытия использовались утилиты `gcov` и `lcov`.

Настройка была произведена в соответствии со [статьёй](https://docs.kernel.org/dev-tools/gcov.html). В ней же можно на

Стоит отметить, что `gcov` запускался на хостовой машине (`BUILD machine` в терминах статьи), поэтому для сбора покрытия использовался скрипт [gather_on_test.sh](https://docs.kernel.org/dev-tools/gcov.html#appendix-b-gather-on-test-sh).
